name: "anchor_mr_eurusd_m5"
symbol: "EURUSD"
timeframe: "M5"
data_path: "data/anchor_reversion_fx/data/eurusd_m5_features_from_parquet.csv"

instrument:
  data_source: "csv"
  pip_size: 0.0001

dataset_registry:
  registry_dir: "data/registry"
  allow_override: false
  append_match_event: false

# ✅ Runtime enrichment: attach raw_regime + state_regime using configs/regime_fx.yaml
regime_fx:
  enabled: true
  config_path: "configs/regime_fx.yaml"

strategy:
  name: "AnchorReversionFX"
  params:
    qty: 1.0
    shock_z_entry: 4.0
    min_dist_pips: 30
    col_dist_pips: "spread_ny_open"
    dist_is_price: true
    horizon_bars: 24
    sessions: null
    col_shock_z: "shock_z"
    col_close: "close"
    pip_size: 0.0001
    sl_mode: "none"
    catastrophic_sl_pips: 300.0

execution:
  policy_id: "baseline"
  entry_delay_bars: 0

costs:
  spread_pips: 0.8
  slippage_pips: 0.2
  commission: 0.0
  spread_pips_effective: 0.8
  slippage_pips_effective: 0.2

risk:
  max_daily_loss_R: null
  max_trades_per_day: null
  cooldown_bars: 12
  allow_missing_sl: true
  risk_proxy_price: 0.0010
  force_exit_on_eof: true

  # edge hold bars
  max_holding_bars: 24
  eof_buffer_bars: 24

  max_concurrent_positions: 1
  time_window_enabled: false
  window_start_utc: "13:30"
  window_end_utc: "16:00"

  # ✅ NEW: engine-level regime exit
  regime_exit_enabled: true
  regime_exit_col: "state_regime"
  regime_exit_allowed: ["RANGE"]

  # ✅ OPTIONAL: gate entries by regime (si quieres replicar edge más estricto)
  regime_gate_entries_enabled: true
  regime_gate_entries_col: "state_regime"
  regime_gate_entries_allowed: ["RANGE"]

guardrails:
  max_holding_bars: 24
